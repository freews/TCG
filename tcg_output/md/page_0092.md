Revert is an object method that operates on objects in the Admin SP’s SP table. The TPer SHALL NOT permit Revert to be invoked on the SP objects of issued SPs.

Invoking Revert on an SP object causes the SP to revert to its Original Factory State. This method allows the TPer owner (or TPer manufacturer, if access control permits and the Maker authorities are enabled) to remove the SP owner’s ownership of the SP and revert the SP to its Original Factory State.

Invocation of Revert is permitted on Manufactured SPs that are in any life cycle state. Successful invocation of Revert on a Manufactured SP that is in the Manufactured-Inactive life cycle state SHALL have no effect on the SP.

This method operates within a Read-Write session to the Admin SP. The TPer SHALL revert the SP immediately after the method is successfully invoked outside of a transaction. If Revert is invoked on the Admin SP’s object in the SP table, the TPer SHALL abort the session immediately after reporting status of the method invocation if invoked outside of a transaction. The TPer MAY prepare a CloseSession method for retrieval by the host to indicate that the session has been aborted.

The MethodID for Revert SHALL be 0x00 00 00 06 00 00 02 02.

## 5.1.2.1 Revert Support

Support for Revert within transactions is (N), and the behavior of Revert within transactions is out of the scope of this specification.

Support for Revert on the Admin SP’s object in the SP table is Mandatory. (Note that the OFS of the Admin SP is Manufactured, see section 5.2.2).

If the Locking SP was created in manufacturing, support for Revert on the Locking SP’s object in the SP table is Mandatory.

## 5.1.2.2 Effects of Revert

Upon successful invocation of the Revert method, the following changes SHALL be made:

- If the Locking SP is not in the “Manufactured-Inactive” life cycle state, then successful invocation of the Revert method on the Locking SP or Admin SP SHALL cause user data removal as defined by the ActiveDataRemovalMechanism (see Table 33) and cause the media encryption keys to be eradicated, which has the side effect of securely erasing all data in the User LBA portion of the Storage Device.

- If the Locking SP is in the “Manufactured-Inactive” life cycle state, then successful invocation of the Revert method on the Locking SP SHALL NOT cause user data removal in the Storage Device.

Interactions with interface commands during the processing of the Revert method are defined in [4].

If any TCG reset occurs prior to completing user data removal and the eradication of all media encryption keys in the Storage Device, then the Revert operation SHALL be aborted and the Locking SP SHALL NOT revert to its Original Factory State.

**Start of Informative Comment**

If any TCG reset occurs during the processing of the Revert method, the result of user data removal is undefined and the TPer does not erase personalization of the Locking SP. For example, the PIN column value for each row in C_PIN table is unchanged.

**End of Informative Comment**

Upon completion of user data removal and the eradication of all media encryption keys in the Storage Device, or if the Locking SP is in the “Manufactured-Inactive” life cycle state, the following changes SHALL be made:

- The row in the Admin SP’s SP table that represents the invoked SP SHALL revert to its original factory values.