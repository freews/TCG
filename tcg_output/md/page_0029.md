### Table 12 - Data Removal Time (Data Removal Time Format bit= 1) (continued)

|-------|-------|
| FIELD | VALUE |
| b) | all open sessions SHALL be aborted on all ComIDs; |
| c) | all uncommitted transactions SHALL be aborted on all ComIDs; |
| d) | the synchronous protocol stack for all ComIDs SHALL be reset to its initial state |
| e) | all TCG command and response buffers SHALL be invalidated for all ComIDs; |
| f) | all related method processing occurring on all ComIDs SHALL be aborted; |
| g) | The TPer’s knowledge of the host’s communications capabilities, on all ComIDs, SHALL be reset to the initial minimum assumptions defined in [2] or the TPer’s SSC definition; |
| h) | the values of the ReadLocked and WriteLocked columns SHALL be set to True for all Locking SP’s Locking objects that contain the Programmatic enumeration value in the LockedOnReset column; |
| i) | the value of the Done column of the Locking SP’s MBRControl table SHALL be set to False, if the DoneOnReset column contains the Programmatic enumeration value. |

The TPER_RESET command is delivered by the transport IF-SEND command. If the TPER_RESET command is enabled, the TPer SHALL accept and acknowledge it at the interface level. If the TPER_RESET command is disabled, the TPer SHALL abort it at the interface level with the “Other Invalid Command Parameter” status (see [4]). There is no IF-RECV response to the TPER_RESET command.

The TPER_RESET command is defined in Table 13.

The Transfer Length SHALL be non-zero. All data transferred SHALL be ignored.

## Table 13 - TPER_RESET Command

|-------|-------|
| FIELD | VALUE |
| Command | IF-SEND |
| Protocol ID | 0x02 |
| Transfer Length | Non-zero |
| ComID | 0x0004 |

## 3.3 Communications

### 3.3.1 Communication Properties

The TPer SHALL support the minimum communication buffer size as defined in section 4.1.1.1. For each ComID, the physical buffer size SHALL be reported to the host via the Properties method.

The TPer SHALL terminate any IF-SEND command whose transfer length is greater than the reported MaxComPacketSize size for the corresponding ComID. For details, refer to “Invalid Transfer Length parameter on IF-SEND” in [4].

Data generated in response to methods contained within an IF-SEND command payload subpacket (including the required ComPacket / Packet / Subpacket overhead data) SHALL fit entirely within the response buffer. If the method response and its associated protocol overhead do not fit completely within the response buffer, the TPer

1) SHALL terminate processing of the IF-SEND command payload,  
2) SHALL NOT return any part of the method response if the Sync Protocol is being used, and  
3) SHALL return an empty response list with a TCG status code of RESPONSE_OVERFLOW in that method’s response status list.

### 3.3.2 Supported Security Protocols

The TPer SHALL support:

- IF-RECV commands with a Security Protocol values of 0x00, 0x01, 0x02.