## 5.1.3 RevertSP – Base Template SP Method

RevertSP is an Opal SSC-specific method for managing the life cycle of an SP, if it was created in manufacturing (Manufactured SP). The following pseudo-code is the signature of the RevertSP method (see [2] for more information).

```
ThisSP.RevertSP[ KeepGlobalRangeKey = boolean ]
=> 
[ ]
```

RevertSP is an SP method in the Base Template.

Invoking RevertSP method on an SP SHALL cause it to revert to its Original Factory State. This method allows the SP owner to relinquish control of the SP and revert the SP to its Original Factory State.

This method operates within a Read-Write session to an SP. The TPer SHALL revert the SP immediately after the method is successfully invoked outside of a transaction. Upon completion of reverting the SP, the TPer SHALL report status of the method invocation if invoked outside of a transaction, and then immediately abort the session. The TPer MAY prepare a CloseSession method for retrieval by the host to indicate that the session has been aborted.

The MethodID for RevertSP SHALL be 0x00 00 00 06 00 00 00 11.

## 5.1.3.1 RevertSP Support

Support for RevertSP within transactions is (N), and the behavior is out of the scope of this document.

If the Locking SP was created in manufacturing, support for RevertSP on the Locking SP is Mandatory.

## 5.1.3.2 KeepGlobalRangeKey parameter (Locking Template-specific)

The Optional KeepGlobalRangeKey parameter is a Locking Template-specific parameter. This parameter provides a mechanism for the Locking SP to be “turned off” without eradicating the media encryption key for the Global Locking Range. This allows the Locking SP to be disabled without causing removal of the user data associated with the Global Locking Range.

When this parameter is present and set to True, the TPer SHALL NOT erase data associated with the Global Locking Range after the Locking SP transitions to the “Manufactured-Inactive” state even if the valid value is set to the ActiveDataRemovalMechanism parameter in DataRemovalMechanism table.

If the Global Range is either Read Unlocked or Write Unlocked at the time of invocation of RevertSP, then the TPer SHALL comply with the request to keep the user data associated with the Global locking range and the Global Range’s-media encryption key.

If the Global Range is Read Locked and Write Locked then invocation of the RevertSP method with the KeepGlobalRangeKey parameter set to True SHALL fail with status FAIL, and the SP SHALL NOT change life cycle states.

If the Locking SP was created in manufacturing, support for the KeepGlobalRangeKey parameter is Mandatory for the Locking SP.

The parameter number for KeepGlobalRangeKey SHALL be 0x060000.

## 5.1.3.3 Effects of RevertSP

Upon successful invocation of the RevertSP method, the following changes SHALL be made:

- If the KeepGlobalRangeKey parameter is not present or set to False, then successful invocation of the RevertSP method on the Locking SP or Admin SP SHALL cause user data removal as defined by the ActiveDataRemovalMechanism (see Table 33) and cause the media encryption keys to be eradicated, which has the side effect of securely erasing all data in the User LBA portion of the Storage Device.